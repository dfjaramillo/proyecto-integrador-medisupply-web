<div class="report-container">
  <div class="header">
    <h1 i18n="@@reports.operational.title">Reporte operativo</h1>
    <div class="breadcrumb">
      <span class="breadcrumb-link" i18n="@@reports.operational.breadcrumbSales">Ventas</span>
      <span class="breadcrumb-separator">-</span>
      <span class="breadcrumb-current" i18n="@@reports.operational.breadcrumbCurrent">Reporte operativo</span>
    </div>
  </div>
    

  <!-- Loading State -->
  <div class="loading" *ngIf="loading()">
    <mat-spinner diameter="50"></mat-spinner>
    <p i18n="@@reports.operational.loading">Cargando reporte...</p>
  </div>

  <!-- Error State -->
  <div class="error" *ngIf="error()">
    <p>{{ error() }}</p>
  </div>

  <!-- Empty State -->
  <div class="empty" *ngIf="isEmptyState()">
    <span i18n="@@reports.operational.empty">No hay datos para el período seleccionado.</span>
  </div>

  <div class="grid" *ngIf="!loading() && !error() && !isEmptyState()">
    <!-- Distribución mensual de pedidos -->
    <div class="card">
      <h2 i18n="@@reports.operational.monthlyOrdersTitle">Distribución mensual de pedidos durante el último año</h2>
      <div class="chart-wrapper">
        <canvas baseChart
          [data]="ordersBarConfig().data"
          [type]="ordersBarConfig().type"
          [options]="ordersBarConfig().options"></canvas>
      </div>
    </div>

    <!-- TOP 5 Clientes -->
    <div class="card">
      <h2 i18n="@@reports.operational.topClientsTitle">TOP 5 Clientes con más pedidos en el último semestre</h2>            
      <table mat-table [dataSource]="topClients()" class="clients-table" *ngIf="topClients().length; else noClients">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef><span i18n="@@reports.operational.clientHeader">CLIENTE</span></th>
          <td mat-cell *matCellDef="let c">{{ c.name }}</td>
        </ng-container>
        <ng-container matColumnDef="orders">
          <th mat-header-cell *matHeaderCellDef><span i18n="@@reports.operational.ordersHeader">CANTIDAD DE PEDIDOS</span></th>
          <td mat-cell *matCellDef="let c">{{ c.orders }}</td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedClientColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedClientColumns"></tr>
      </table>
      <ng-template #noClients>
        <div class="empty-mini" i18n="@@reports.operational.emptyMini">No hay datos para el período seleccionado.</div>
      </ng-template>
    </div>

    <!-- Crecimiento mensual ventas -->
    <div class="card">
      <h2 i18n="@@reports.operational.monthlySalesGrowthTitle">Crecimiento mensual de ventas (COP)</h2>
      <div class="chart-wrapper">
        <canvas baseChart
          [data]="amountLineConfig().data"
          [type]="amountLineConfig().type"
          [options]="amountLineConfig().options"></canvas>
      </div>
    </div>

    <!-- TOP 10 Productos -->
    <div class="card">
      <h2 i18n="@@reports.operational.topProductsTitle">TOP 10 Productos más vendidos</h2>
      <div class="chart-wrapper">
        <canvas baseChart
          [data]="productsBarConfig().data"
          [type]="productsBarConfig().type"
          [options]="productsBarConfig().options"></canvas>
      </div>
    </div>
  </div>
</div>
