<div class="route-detail-dialog">
  <div class="dialog-header">
    <div class="header-content">
      <button
        mat-icon-button
        class="back-btn"
        (click)="onClose()"
        i18n-aria-label="@@routes.routeDetailDialog.backAria" aria-label="Volver al listado"
      >
        <mat-icon>arrow_back</mat-icon>
      </button>
      <h2>{{ route.route_code }}</h2>
    </div>
  </div>

  <mat-dialog-content>
    <!-- Información de la ruta -->
    <div class="route-info">
      <div class="info-grid">
        <div class="info-item">
          <span class="label" i18n="@@routes.routeDetailDialog.routeCodeLabel">Código de Ruta:</span>
          <span class="value">{{ route.route_code }}</span>
        </div>
        <div class="info-item">
          <span class="label" i18n="@@routes.routeDetailDialog.truckLabel">Camión Asignado:</span>
          <span class="value">{{ route.assigned_truck }}</span>
        </div>
        <div class="info-item">
          <span class="label" i18n="@@routes.routeDetailDialog.deliveryDateLabel">Fecha de Entrega:</span>
          <span class="value">{{ formatDate(route.delivery_date) }}</span>
        </div>
        <div class="info-item">
          <span class="label" i18n="@@routes.routeDetailDialog.productTypeLabel">Tipo de Productos:</span>
          <span class="value" i18n="@@routes.routeDetailDialog.coldChainValue">Cadena de frío</span>
        </div>
      </div>
    </div>

    <!-- Contenedor del mapa - siempre presente -->
    <div class="map-container">
      <!-- Elemento del mapa de Google Maps -->
      <div class="google-map"></div>
      
      <!-- Spinner de carga sobre el mapa -->
      @if (loading()) {
      <div class="loading-overlay">
        <mat-spinner diameter="50"></mat-spinner>
        <p i18n="@@routes.routeDetailDialog.loadingMap">Cargando mapa...</p>
      </div>
      }
      
      <!-- Leyenda del mapa -->
      @if (mapInitialized()) {
      <div class="map-legend">
        <div class="legend-item">
          <span class="legend-marker start"></span>
          <span class="legend-text" i18n="@@routes.routeDetailDialog.legendStart">Punto de inicio</span>
        </div>
        <div class="legend-item">
          <span class="legend-marker waypoint"></span>
          <span class="legend-text" i18n="@@routes.routeDetailDialog.legendWaypoint">Punto de entrega</span>
        </div>
        <div class="legend-item">
          <span class="legend-marker end"></span>
          <span class="legend-text" i18n="@@routes.routeDetailDialog.legendEnd">Punto final</span>
        </div>
      </div>
      }
    </div>
  </mat-dialog-content>
</div>
